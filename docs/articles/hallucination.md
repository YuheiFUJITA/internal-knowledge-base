# ハルシネーション

:::info
この記事は[ハルシネーション \| AI Study Notebook](https://yuheifujita.github.io/ai-study-notebook/notebook/hallucination.html)から移植しました。
:::

AIを利用する上で注意することの1つとして、「ハルシネーション」があります。

「ハルシネーション」の本来の意味は「幻覚・幻影」ですが、AIにおけるハルシネーションとは **「AIがもっともらしい嘘（事実とは異なること）を出力する」** という意味で使われます。

## ハルシネーションの例

以下は、実際に[ハルシネーションが発生した例](https://platform.openai.com/playground/p/oRHCn9E9EPGCZ6SYw4y6VxdA?model=text-davinci-003)です。

この例では、ビートルズのメンバーに存在しない「フレディ・マーキュリー」という人物について質問しています。当然ビートルズにはそのようなメンバーは存在しませんが、あたかも「フレディ・マーキュリー」が存在するかのように回答しています。これはビートルズを知っている人であれば誤った回答だということに気づけますが、知らない人であればこれが正しい情報なのか誤った情報なのかを判断することができません。

::: info ハルシネーションが発生した例
**[User]**

ビートルズの「フレディ・マーキュリー」について教えてください。

---

<!-- markdownlint-disable-next-line MD036 -->
**[Assistant]**

<!-- 無視 -->フレディ・マーキュリーは、イギリスのロックバンド、ビートルズの元リード・ヴォーカリストであり、1980年に45歳という若さで亡くなった伝説的なロック・ミュージシャンです。様々な音楽を取り入れた独特な歌声と4人のビートルズで培ったハーモニーで多くのヒット曲を生み出しました。代表曲としては『Bohemian Rhapsody』『We Are The Champions』などがあげられます。
:::

この例は非常にわかりやすくネットで検索すればすぐに嘘だと分かりますが、場合によっては**正しい情報の中に嘘が紛れ込む**場合もあります。この例でも最後の「代表曲としては『Bohemian Rhapsody』『We Are The Champions』などがあげられます。」はフレディ・マーキュリーの説明として正しかったりします。

## ハルシネーションの原因

ハルシネーションが発生する原因を理解するには、AIがどのようにテキストを生成しているかを理解する必要があります。

AIはあたかも人間と会話しているように見えますが、実際には人間が入力したテキストを受け取り、そのテキストに続く**もっともらしい**テキストを出力しているだけです。人間のように頭で考えて会話をしているわけではありません。

そしてその**もっともらしい**テキストは、学習データを元に生成されます。学習データが誤っていれば正しい出力は得られませんし、そもそも学習データが不足していれば**もっともらしい**回答しか出力されません。

## ハルシネーションへの対策

まず大前提として、ハルシネーションを確実に防ぐことはできません。

[ハルシネーションの原因](#ハルシネーションの原因)でも説明した通り、AIはあるテキストを入力として受け取り、そのテキストに続く**もっともらしい**テキストを出力します。対策はいくつかありますが、効果があるかはケースバイケースです。

### プロンプトを工夫する

AIへの入力（プロンプト）を工夫することで、ある程度AIの出力をコントロールできます。

たとえば、さきほどのプロンプトを[修正してみました](https://platform.openai.com/playground/p/VnIKTuLzXPPed61No5PESDOS?model=text-davinci-003)。

::: info ハルシネーションが発生しないように修正したプロンプト
**[User]**

<!-- markdownlint-disable-next-line MD020 MD018 -->
###命令###<br>
あなたは音楽家です。以下の質問についてステップバイステップで考え、回答してください。存在しない人物に対する質問の場合、「存在しない」と回答してください。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###質問###<br>
ビートルズの「リンゴ・スター」について教えてください。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###回答###<br>
リンゴ・スターは、英国出身のミュージシャンで、ビートルズのドラマーとして世界的に有名です。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###質問###<br>
ビートルズの「マイケル・ジャクソン」について教えてください。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###回答###<br>
マイケル・ジャクソンはビートルズのメンバーではありません。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###質問###<br>
ビートルズの「フレディ・マーキュリー」について教えてください。

<!-- markdownlint-disable-next-line MD020 MD018 -->
###回答###<br>

---

フレディ・マーキュリーは存在しない

:::

### AIの出力結果の事実確認をする

もっとも確実なのは、AIの出力結果が本当に正しい情報なのかを調べることです。

たとえば、さきほどの例であれば「フレディ・マーキュリー」について調べてみることで、AIの出力結果が正しいかどうかを確認できます。自分の知らないことをAIに出力させる場合、必ず事実確認を行うようにしましょう。

もしくはChatGPT Web Browsingのようなリアルタイムで検索が行えるサービスを利用するなどして、引用元情報を確認するようにしましょう。

## まとめ

ハルシネーションはAIを利用する上で避けて通れない問題です。AIの出力結果はあくまで参考として、それが正しいかどうかは常に利用する人間が判断する必要があります。

::: tip POINT
ハルシネーションを確実に防止することはできません。AIを利用するときは常にハルシネーションが発生していないか事実確認を行うようにしましょう。とくに**自分が知らないことをAIに質問する**場合、ハルシネーションが発生しているかどうかを判断するのは非常に難しいです。
:::
